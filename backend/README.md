To install
```bash
pip install fastapi
pip install "uvicorn[standard]"
pip install websockets
```
To start
```bash
uvicorn main:app --reload
```
Endpoints:
```
http://127.0.0.1:8000
http://127.0.0.1:8000/docs
```
Описание
> http://127.0.0.1:8000/initializeCenters

<pre>
(GET)
- Ничего не принимает на вход
- Возвращает {message: "OK"}
- В результате создает структуру удостоверяющих центров
(Первый - корневой, в нем зарегистрировны Второй и Третий
Четвертый центр стоит сам по себе)
</pre>

---
> http://127.0.0.1:8000/getCertificationCenters

<pre>
(GET)
- Ничего не принимает на вход
- Возвращает имена удостоверяющих центров
</pre>
Пример возвращаемых значений
```json
[
  "Первый удостоверяющий центр",
  "Второй удостоверяющий центр",
  "Третий удостоверяющий центр",
  "Четвертый удостоверяющий центр"
]
```
---
> http://127.0.0.1:8000/registerInCenter/{center_id}

<pre>
(GET)
- На вход в path параметре (center_id) принимает имя удостоверяющиего центра
- Возвращает структуру с сертификатом, ключами пользователя и проверками
</pre>
Пример возвращаемых значений
```json
{
  "certificate": {
    "certification_center_public_key": {
      "p": "15077448271697558714247597949521913993678586244525060414462354584014394735995072542127381400377023958730569427283337856632597520780954926652287191108018337",
      "q": "91281503416945889652918703770352990937878253512013856412498077588816013140439",
      "a": "6592752606611220654105067799679540743048351830044452271117496023017642129329803229577761146313965306522030103606917649616700871071643980451287654533981420",
      "y": "5690730469591722304564615411182231431734504733579347526324290504127603275053205213398343653884720010561737728903484053886889430827731565202685831261976390"
    },
    "user_public_key": {
      "p": "26935564504513642429006446534785956683225891369878249548880810196479559456246388804907906014288434382805713953044006112970023844856817347072439185080187327",
      "q": "106012862172437007133221558679937230667290553677676961714383547955787358574259",
      "a": "12834314431865865352735803739081859802190644532085915075894657673751160042273165728472083017117520746207748292911282285938426113001606956000638526176162710",
      "y": "23728671406263202165084760236608091404088298952146631192293310779143696078571272957546144512270265899701087584239108266362830701456610803034789096142862544"
    }
  },
  "certificate_sign": {
    "h": "46140662452629120813100692018938269047983209769687169638693494077083514504957",
    "w2": "83564477705966270834362928599542964896494380312860102503147802745082630862260",
    "s": "27336166437817425765097261686744178317277842449294220670138123603672045442908"
  },
  "parent_certificates": [
    {
      "name": "Первый удостоверяющий центр",
      "certification_center_public_key": {
        "p": "20511581895326626610154562357205136480544485293794415598181809575609138557269952976505087279532668689936196794482554700061567944566484851867946044093652783",
        "q": "64702992039053753277171286934874828078708068980989572695084977568072231103191",
        "a": "17871408834078221866478850749318719805374054599660553555996364991441176311099760333624864143351107955344961594277801622615129163486363989588444460378944546",
        "y": "17201421460227690607544074522057526728330368044534325106796766121371443525301409014488855587375434753079489433767714624988393426857921794799362231828500171"
      },
      "certificate_signature": {
        "h": "48104263853461717356909066247929258188954094750647677741300708885176688929730",
        "w2": "52016576280690460412194390360419769032872532137579195150989007325933335784043",
        "s": "39505519767368103865986254487971620127823867077448563952539724778810253410750"
      },
      "public_key": {
        "p": "15077448271697558714247597949521913993678586244525060414462354584014394735995072542127381400377023958730569427283337856632597520780954926652287191108018337",
        "q": "91281503416945889652918703770352990937878253512013856412498077588816013140439",
        "a": "6592752606611220654105067799679540743048351830044452271117496023017642129329803229577761146313965306522030103606917649616700871071643980451287654533981420",
        "y": "5690730469591722304564615411182231431734504733579347526324290504127603275053205213398343653884720010561737728903484053886889430827731565202685831261976390"
      }
    }
  ],
  "public_keys": {
    "p": "26935564504513642429006446534785956683225891369878249548880810196479559456246388804907906014288434382805713953044006112970023844856817347072439185080187327",
    "q": "106012862172437007133221558679937230667290553677676961714383547955787358574259",
    "a": "12834314431865865352735803739081859802190644532085915075894657673751160042273165728472083017117520746207748292911282285938426113001606956000638526176162710",
    "y": "23728671406263202165084760236608091404088298952146631192293310779143696078571272957546144512270265899701087584239108266362830701456610803034789096142862544"
  },
  "private_keys": {
    "x": "99125909330089557710489038702394354348191346104572518712736997381344028171185"
  },
  "pChecks": [
    "Ферма с n=21797171235315469998544041826461620935744591162603971940312677560862863575105337400884277633839559764106172084777345648565532002441852860052748792619270466\n",
    "Ферма с n=9283528379280502214177980365290846792987346645607275652394989754646565137332680117572949421457935972011455239627131354277243978582018439717682037501699077\n",
    "Ферма с n=24264042183457458062211827734293482835066388211358998263452060411508738523228481292483856181336156900770247381750355101329114592290149864555756615145839800\n", "Ферма с n=19437928459294029747198263087395250457819249627315701446990740172774839513584762459112451483153739323351315063876720759217213386288145472266507361062719929\n",
    "Миллер-Рабин с n=19498999068446903928824596110988111714103223422082860671527302696061338921636116480550708645740225008326245515393266592279137030838168672047660625020194846\n",
    "Миллер-Рабин с n=7627779808560831118365923976563024044523665221280298493203976581939612410163295295450184827763258842035091414895084789398881257410413569463134717376210117\n",
    "Миллер-Рабин с n=1246165688956459939791721675865793178188836731107456978025130459386169586066862117671918788508002712808141043385194976413937501534466683223070840539388658\n",
    "Миллер-Рабин с n=7403198259497277498332405189995543850768212346349762573872844594491689258004696091614841590201466449272927509886516175929535949203038069451059733232865828\n",
    "Миллер-Рабин с n=15294134575527800935265727187735321149668024973503011431073926074011564942907688488231999681437333275218340251152483908142811505395001293850299817511296068\n",
    "Миллер-Рабин с n=13561211900321340851792920126468666607417861516767356132742668132398584834201168400346439290004194125175207115927135917658998114823410985854910785730525324\n"
  ],
  "qChecks": [
    "Ферма с n=57243967666541615940539051806238640758116967020578526804515650738333607217404\n",
    "Ферма с n=74730514133219860829671012983983224136625418756811726875161769850906737032643\n",
    "Ферма с n=24158332345753297459645844834960237801252762323012958497400199933482992921329\n",
    "Ферма с n=99954928642210216983219269092446426084504492322822072419727382389775549000468\n",
    "Ферма с n=92025563287183681847483838785561775355593443644474218339184930406172131571675\n",
    "Миллер-Рабин с n=77818457129880596036592669745281412413189122322589321005488695248126269172844\n",
    "Миллер-Рабин с n=67148338580245380235338189594690494446573176515392687245409300016887096903744\n",
    "Миллер-Рабин с n=61559836630272504208577868894173148884024331885915168955400246577462527359787\n",
]
}
```

```json
{
  "certificate (сертификат пользователя (его подписывает центр))": {
    "certification_center_public_key (публичный ключ удостоверяющего центра в котором зарегистрирован пользователь)": {
      "p (публичные ключи)": "str",
      "q (публичные ключи)": "str",
      "a (публичные ключи)": "str",
      "y (публичные ключи)": "str"
    },
    "user_public_key (публичный ключ пользователя)": {
      "p (публичные ключи)": "str",
      "q (публичные ключи)": "str",
      "a (публичные ключи)": "str",
      "y (публичные ключи)": "str"
    }
  },
  "certificate_sign (подпись центра)": {
    "h (подпись)": "str",
    "w2 (подпись)": "str",
    "s (подпись)": "str"
  },
  "parent_certificates (подписи УЦ, в которых зарегистрирован сам УЦ пользователя)": [
    {
      "name (имя где был зарегистрирован)": "str",
      "certification_center_public_key (публичные ключи УЦ регистратора)": {
        "p (публичные ключи)": "str",
        "q (публичные ключи)": "str",
        "a (публичные ключи)": "str",
        "y (публичные ключи)": "str"
      },
      "certificate_signature (подпись УЦ клиента)": {
        "h (хэш сообщения)": "str",
        "w2 (подпись)": "str",
        "s (подпись)": "str"
      },
      "public_key (публичный ключ УЦ клиента)": {
        "p (публичные ключи)": "str",
        "q (публичные ключи)": "str",
        "a (публичные ключи)": "str",
        "y (публичные ключи)": "str"
      }
    }
  ],
  "public_keys (публичные ключи пользователя)": {
    "p (публичные ключи)": "str",
    "q (публичные ключи)": "str",
    "a (публичные ключи)": "str",
    "y (публичные ключи)": "str"
  },
  "private_keys (приватные ключ)": {
    "x (приватный ключ)": "str"
  },
  "pChecks (проверки для p)": [
    "str"
  ],
  "qChecks (проверки для q)": [
    "str"
  ]
}

```
---
> http://127.0.0.1:8000/signMessage

<pre>
(POST)
- Принимает на вход body, с ключами и сообщением (ОБЯЗАТЕЛЬНО В ВИДЕ СТРОКИ, ОБЪЕКТЫ КОНВЕРТИТЬ В JSON СТРОКУ)
- Возвращает подпись
</pre>
Пример принимаемых
```json
{
    "p": "30345488338139628755086788140068929620462209911540544273094928581399103390539182593823194975891915106101997527317752059924143578898123914679393400535258363",
    "q": "110781651462665063391586786624504234613310579507008113206192929563766402286077",
    "a": "8701261081936027199722260110459931885463214175110781200683112480951339211868929466933091088990514945694588492074738869961679516490104699827466549972295990",
    "x": "40527940678042217174382738782472588502506805845841684682882148587875699594623",
    "y": "12625953093720707341342643697264800091648034027511293240299626208940507449006856480253612752999584801627347376278298377352159359591583995942014153366629268",
    "message": "фыв"
}
```
```json
{
  "p (публичные ключи)": "str",
  "q (публичные ключи)": "str",
  "a (публичные ключи)": "str",
  "y (публичные ключи)": "str",
  "x (приватные ключи)": "str",
  "message (подписываемое сообщение)": "str"
}
```
Пример возвращаемых значений
```json
{
    "w2": "22201304540647202406391433638363223389088762707207818283395183809661194053085",
    "s": "30045232708447055032883214689178252926878694873860746418064688680892003878514",
    "h": "73961085014367132910592175700063418359627614481230910248505403494774335724766"
}
```
```json
{
    "w2 (подпись сообщения)": "str",
    "s (подпись сообщения)": "str",
    "h (хэш сообщения)": "str"
}
```
---
> http://127.0.0.1:8000/verifySignature

<pre>
(POST)
- Принимает на вход body, с ключами и подписью и сообщением (ОБЯЗАТЕЛЬНО В ВИДЕ СТРОКИ, ОБЪЕКТЫ КОНВЕРТИТЬ В JSON СТРОКУ)
- Возвращает подпись
</pre>
Пример принимаемых
```json
{
    "p": "15854819674408014846360792277766095840164247858167534469149596735835912968905610390319528206133321045606010752942804972423234446448434182359579817962687551",
    "q": "73414482672894823354019877989723497550572796812424464116874005028352693115637",
    "a": "9973201391719854053437965372531257109939468865677638581297896428767730968350974849052830306594270086678052466596850475535924229742364678437647622692744129",
    "y": "9092937753650993542250612657653419670554569122243005504921736564993669238096632945795168267421608907593907549546053700886501297577854299148291112948537165",
    "message": "Привет",
    "w2": "43657860494932585197119906502646501399631549854705105533269691793975209421827",
    "s": "69664150489156881045362164074898704492950663731719211470583476428708851559786",
}
```
```json
{
    "p (публичные ключи)": "str",
    "q (публичные ключи)": "str",
    "a (публичные ключи)": "str",
    "y (публичные ключи)": "str",
    "message (сообщение)": "str",
    "w2 (подпись)": "str",
    "s (подпись)": "str"
}
```
Пример возвращаемых значений
```json
{
    "isCorrect": true,
    "h": "39748753086746803757742226324431269309326863714139574275697253751010020058499"
}
```
```json
{
    "isCorrect (корректность подписи)": "bool",
    "h (хэш сообщения)": "str"
}
```
---
> http://127.0.0.1:8000/ws/{client_id}

<pre>
(WEBSOCKET)
- Принимает на вход параметр в query, client_id - любая строка (уникальность на вашей стороне) 
- Отправляет либо всем, либо кому-то по client_id
- При новых соединениях отправляет список текущих пользователей
- При отключении оповещает всех пользователей
</pre>
Пример принимаемых
```json
{
  "message": {
    "что-то": "что-то"
  },
  "toId": "123123"
}
```
```json
{
  "message (что придет клиенту)": "object",
  "toId (кому отправить)": "123123"
}
```
Пример возвращаемых значений
```json
{
        "type": "CURRENT_CONNECTIONS",
        "currentConnections": [
          "123123",
          "12312142"
        ]
}
```